# ğŸ“ ç³»ç»Ÿæ¶æ„è®¾è®¡æ–‡æ¡£

## 1. æ€»ä½“æ¶æ„

### 1.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å®¢æˆ·ç«¯å±‚ (Client)                         â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Webæµè§ˆå™¨   â”‚  â”‚  ç§»åŠ¨æµè§ˆå™¨   â”‚  â”‚   APIå®¢æˆ·ç«¯   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    HTTPS (Port 443/8080)
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ¥å…¥å±‚ (Gateway)                          â”‚
â”‚                                                                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                    â”‚  Nginx (Alpine) â”‚                         â”‚
â”‚                    â”‚  - åå‘ä»£ç†      â”‚                         â”‚
â”‚                    â”‚  - é™æ€èµ„æº      â”‚                         â”‚
â”‚                    â”‚  - SSLç»ˆæ­¢       â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å±‚ (Application)                        â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           FastAPI Application (Python 3.11)             â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚              APIè·¯ç”±å±‚ (Routes)                   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  - /api/v1/generate  (ç”Ÿæˆå›¾åƒ)                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  - /api/v1/task      (ä»»åŠ¡ç®¡ç†)                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  - /api/v1/history   (å†å²è®°å½•)                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  - /api/v1/system    (ç³»ç»Ÿä¿¡æ¯)                  â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                        â”‚                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚            ä¸šåŠ¡é€»è¾‘å±‚ (Services)                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ ImageGenerator   â”‚  â”‚  TaskManager      â”‚     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ - å›¾åƒç”Ÿæˆé€»è¾‘    â”‚  â”‚  - ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†   â”‚     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ - å‚æ•°éªŒè¯       â”‚  â”‚  - çŠ¶æ€è¿½è¸ª       â”‚     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ VolcEngineServiceâ”‚  â”‚  StorageService   â”‚     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ - SDKå°è£…        â”‚  â”‚  - æ–‡ä»¶ç®¡ç†       â”‚     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ - APIè°ƒç”¨        â”‚  â”‚  - å›¾ç‰‡å­˜å‚¨       â”‚     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                        â”‚                                 â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚           æ•°æ®è®¿é—®å±‚ (Data Access)                â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  - SQLAlchemy ORM                                â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  - Repository Pattern                            â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                       â”‚
         â–¼                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ•°æ®å±‚ (Data)      â”‚              â”‚  å¤–éƒ¨æœåŠ¡ (External) â”‚
â”‚                     â”‚              â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚              â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ SQLite3 DB    â”‚  â”‚              â”‚ â”‚ VolcEngine API  â”‚ â”‚
â”‚  â”‚ - ä»»åŠ¡è®°å½•    â”‚  â”‚              â”‚ â”‚ - Visual AI     â”‚ â”‚
â”‚  â”‚ - å†å²æ•°æ®    â”‚  â”‚              â”‚ â”‚ - Image Gen     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚              â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚              â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚              â”‚ https://open.       â”‚
â”‚  â”‚ File System   â”‚  â”‚              â”‚   volcengineapi.com â”‚
â”‚  â”‚ - ç”Ÿæˆå›¾ç‰‡    â”‚  â”‚              â”‚                     â”‚
â”‚  â”‚ - ç¼©ç•¥å›¾      â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2. æ•°æ®æµè®¾è®¡

### 2.1 å›¾åƒç”Ÿæˆæµç¨‹

```
ç”¨æˆ· â†’ Webç•Œé¢ â†’ APIç½‘å…³ â†’ åç«¯æœåŠ¡ â†’ ç«å±±å¼•æ“ â†’ è¿”å›å›¾ç‰‡ â†’ å­˜å‚¨ â†’ å±•ç¤º

è¯¦ç»†æ­¥éª¤ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥  â”‚  1. ç”¨æˆ·åœ¨Webç•Œé¢å¡«å†™æç¤ºè¯å’Œå‚æ•°
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‚æ•°éªŒè¯     â”‚  2. å‰ç«¯JavaScriptéªŒè¯è¾“å…¥
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /generateâ”‚  3. å‘é€HTTPè¯·æ±‚åˆ°åç«¯API
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ›å»ºä»»åŠ¡     â”‚  4. åç«¯åˆ›å»ºå¼‚æ­¥ä»»åŠ¡è®°å½•
â”‚  (Pending)   â”‚     - ç”Ÿæˆtask_id
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - å­˜å…¥æ•°æ®åº“
      â”‚              - è¿”å›task_idç»™å‰ç«¯
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼‚æ­¥å¤„ç†     â”‚  5. åå°å¼‚æ­¥å¤„ç†ä»»åŠ¡
â”‚              â”‚     - ä»é˜Ÿåˆ—è·å–ä»»åŠ¡
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - æ›´æ–°çŠ¶æ€ä¸ºProcessing
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨ç«å±±å¼•æ“  â”‚  6. é€šè¿‡SDKè°ƒç”¨ç«å±±å¼•æ“API
â”‚     API      â”‚     - ä¼ é€’å‚æ•°
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - ç­‰å¾…å“åº”
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¤„ç†å“åº”     â”‚  7. å¤„ç†ç«å±±å¼•æ“è¿”å›çš„å›¾ç‰‡
â”‚              â”‚     - ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - ç”Ÿæˆç¼©ç•¥å›¾
      â”‚              - ä¿å­˜æ–‡ä»¶è·¯å¾„
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ›´æ–°ä»»åŠ¡     â”‚  8. æ›´æ–°ä»»åŠ¡çŠ¶æ€
â”‚ (Completed)  â”‚     - çŠ¶æ€æ”¹ä¸ºCompleted
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - è®°å½•å›¾ç‰‡è·¯å¾„
      â”‚              - ä¿å­˜åˆ°å†å²è®°å½•
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯è½®è¯¢     â”‚  9. å‰ç«¯å®šæ—¶æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
â”‚  GET /task   â”‚     - è·å–æœ€æ–°çŠ¶æ€
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     - æ˜¾ç¤ºè¿›åº¦
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å±•ç¤ºå›¾ç‰‡     â”‚  10. ä»»åŠ¡å®Œæˆåå±•ç¤ºå›¾ç‰‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      - æ¸²æŸ“å›¾ç‰‡ç½‘æ ¼
                      - æä¾›ä¸‹è½½æŒ‰é’®
```

### 2.2 ä»»åŠ¡çŠ¶æ€æœº

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  PENDING â”‚  ä»»åŠ¡å·²åˆ›å»ºï¼Œç­‰å¾…å¤„ç†
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚PROCESSINGâ”‚  æ­£åœ¨ç”Ÿæˆå›¾åƒ
         â”‚          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚
         â”‚               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â–¼         â–¼
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚COMPLETED â”‚  â”‚  FAILED  â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â”‚                              â–¼
         â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ RETRYINGâ”‚
                                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                   (å›åˆ°PROCESSING)

çŠ¶æ€è¯´æ˜ï¼š
- PENDING: ä»»åŠ¡å·²åˆ›å»ºï¼Œåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…
- PROCESSING: æ­£åœ¨è°ƒç”¨ç«å±±å¼•æ“APIç”Ÿæˆå›¾åƒ
- COMPLETED: å›¾åƒç”ŸæˆæˆåŠŸï¼Œå·²ä¿å­˜
- FAILED: ç”Ÿæˆå¤±è´¥ï¼ˆè¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°ï¼‰
- RETRYING: ä¸´æ—¶å¤±è´¥ï¼Œæ­£åœ¨é‡è¯•
```

## 3. æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 3.1 åç«¯æ¨¡å—ç»“æ„

```
backend/app/
â”‚
â”œâ”€â”€ main.py                      # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ FastAPIå®ä¾‹åŒ–
â”‚   â”œâ”€â”€ ä¸­é—´ä»¶é…ç½®
â”‚   â”œâ”€â”€ è·¯ç”±æ³¨å†Œ
â”‚   â””â”€â”€ å¯åŠ¨/å…³é—­äº‹ä»¶
â”‚
â”œâ”€â”€ config.py                    # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ Settings (Pydantic)
â”‚   â”œâ”€â”€ ç¯å¢ƒå˜é‡åŠ è½½
â”‚   â””â”€â”€ é…ç½®éªŒè¯
â”‚
â”œâ”€â”€ api/                         # APIè·¯ç”±å±‚
â”‚   â”œâ”€â”€ routes.py               # è·¯ç”±èšåˆ
â”‚   â”œâ”€â”€ generate.py             # å›¾åƒç”Ÿæˆç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ POST /generate
â”‚   â”‚   â””â”€â”€ WebSocket /generate/stream
â”‚   â”œâ”€â”€ task.py                 # ä»»åŠ¡ç®¡ç†ç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ GET /task/{id}
â”‚   â”‚   â”œâ”€â”€ GET /tasks
â”‚   â”‚   â””â”€â”€ DELETE /task/{id}
â”‚   â”œâ”€â”€ history.py              # å†å²è®°å½•ç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ GET /history
â”‚   â”‚   â””â”€â”€ DELETE /history/{id}
â”‚   â”œâ”€â”€ image.py                # å›¾ç‰‡æœåŠ¡ç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ GET /images/{id}
â”‚   â”‚   â””â”€â”€ GET /images/{id}/thumbnail
â”‚   â””â”€â”€ system.py               # ç³»ç»Ÿä¿¡æ¯ç«¯ç‚¹
â”‚       â”œâ”€â”€ GET /health
â”‚       â”œâ”€â”€ GET /info
â”‚       â””â”€â”€ GET /models
â”‚
â”œâ”€â”€ services/                    # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ volcengine.py           # ç«å±±å¼•æ“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ VolcEngineClient
â”‚   â”‚   â”‚   â”œâ”€â”€ initialize_sdk()
â”‚   â”‚   â”‚   â”œâ”€â”€ generate_image()
â”‚   â”‚   â”‚   â”œâ”€â”€ check_quota()
â”‚   â”‚   â”‚   â””â”€â”€ list_models()
â”‚   â”‚   â””â”€â”€ é”™è¯¯å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ image_generator.py      # å›¾åƒç”ŸæˆæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ImageGeneratorService
â”‚   â”‚   â”‚   â”œâ”€â”€ create_task()
â”‚   â”‚   â”‚   â”œâ”€â”€ process_task()
â”‚   â”‚   â”‚   â”œâ”€â”€ validate_params()
â”‚   â”‚   â”‚   â””â”€â”€ save_result()
â”‚   â”‚   â””â”€â”€ å‚æ•°é¢„å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ task_manager.py         # ä»»åŠ¡ç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ TaskManager
â”‚   â”‚   â”‚   â”œâ”€â”€ submit_task()
â”‚   â”‚   â”‚   â”œâ”€â”€ get_task_status()
â”‚   â”‚   â”‚   â”œâ”€â”€ update_task()
â”‚   â”‚   â”‚   â””â”€â”€ cleanup_old_tasks()
â”‚   â”‚   â””â”€â”€ é˜Ÿåˆ—ç®¡ç†
â”‚   â”‚
â”‚   â””â”€â”€ storage.py              # å­˜å‚¨æœåŠ¡
â”‚       â”œâ”€â”€ StorageService
â”‚       â”‚   â”œâ”€â”€ save_image()
â”‚       â”‚   â”œâ”€â”€ generate_thumbnail()
â”‚       â”‚   â”œâ”€â”€ get_image_path()
â”‚       â”‚   â””â”€â”€ cleanup_storage()
â”‚       â””â”€â”€ æ–‡ä»¶ç®¡ç†
â”‚
â”œâ”€â”€ models/                      # æ•°æ®æ¨¡å‹å±‚
â”‚   â”œâ”€â”€ database.py             # æ•°æ®åº“æ¨¡å‹ (SQLAlchemy)
â”‚   â”‚   â”œâ”€â”€ Task (è¡¨: tasks)
â”‚   â”‚   â””â”€â”€ History (è¡¨: history)
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas.py              # APIæ¨¡å‹ (Pydantic)
â”‚   â”‚   â”œâ”€â”€ GenerateRequest
â”‚   â”‚   â”œâ”€â”€ GenerateResponse
â”‚   â”‚   â”œâ”€â”€ TaskStatus
â”‚   â”‚   â””â”€â”€ HistoryItem
â”‚   â”‚
â”‚   â””â”€â”€ enums.py                # æšä¸¾ç±»å‹
â”‚       â”œâ”€â”€ TaskStatus
â”‚       â”œâ”€â”€ ModelType
â”‚       â””â”€â”€ ImageSize
â”‚
â””â”€â”€ utils/                       # å·¥å…·å±‚
    â”œâ”€â”€ logger.py               # æ—¥å¿—å·¥å…·
    â”œâ”€â”€ helpers.py              # è¾…åŠ©å‡½æ•°
    â”œâ”€â”€ validators.py           # éªŒè¯å™¨
    â””â”€â”€ exceptions.py           # è‡ªå®šä¹‰å¼‚å¸¸
```

### 3.2 å‰ç«¯æ¨¡å—ç»“æ„

```
frontend/
â”‚
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ custom.css          # è‡ªå®šä¹‰æ ·å¼
â”‚   â”‚       â”œâ”€â”€ ä¸»é¢˜å˜é‡
â”‚   â”‚       â”œâ”€â”€ ç»„ä»¶æ ·å¼
â”‚   â”‚       â””â”€â”€ åŠ¨ç”»æ•ˆæœ
â”‚   â”‚
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ app.js              # ä¸»åº”ç”¨é€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ Alpine.jsç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ äº‹ä»¶å¤„ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ api.js              # APIè°ƒç”¨å°è£…
â”‚   â”‚   â”‚   â”œâ”€â”€ generateImage()
â”‚   â”‚   â”‚   â”œâ”€â”€ getTaskStatus()
â”‚   â”‚   â”‚   â”œâ”€â”€ getHistory()
â”‚   â”‚   â”‚   â””â”€â”€ é”™è¯¯å¤„ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ utils.js            # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ formatDate()
â”‚   â”‚       â”œâ”€â”€ downloadImage()
â”‚   â”‚       â””â”€â”€ validateForm()
â”‚   â”‚
â”‚   â””â”€â”€ images/
â”‚       â”œâ”€â”€ logo.svg
â”‚       â”œâ”€â”€ placeholder.svg
â”‚       â””â”€â”€ icons/
â”‚
â””â”€â”€ templates/
    â””â”€â”€ index.html              # ä¸»é¡µé¢
        â”œâ”€â”€ å¤´éƒ¨å¯¼èˆª
        â”œâ”€â”€ å‚æ•°é…ç½®é¢æ¿
        â”œâ”€â”€ å›¾åƒå±•ç¤ºåŒº
        â”œâ”€â”€ å†å²è®°å½•ä¾§è¾¹æ 
        â””â”€â”€ æ¨¡æ€æ¡†ç»„ä»¶
```

## 4. æ•°æ®åº“è®¾è®¡

### 4.1 ERå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            tasks                â”‚  ä»»åŠ¡è¡¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         INTEGER         â”‚
â”‚ task_id         VARCHAR(36)     â”‚  UUID
â”‚ status          VARCHAR(20)     â”‚  ä»»åŠ¡çŠ¶æ€
â”‚ prompt          TEXT            â”‚  æç¤ºè¯
â”‚ negative_prompt TEXT            â”‚  è´Ÿé¢æç¤ºè¯
â”‚ model           VARCHAR(50)     â”‚  æ¨¡å‹åç§°
â”‚ width           INTEGER         â”‚  å®½åº¦
â”‚ height          INTEGER         â”‚  é«˜åº¦
â”‚ num_images      INTEGER         â”‚  å›¾ç‰‡æ•°é‡
â”‚ steps           INTEGER         â”‚  é‡‡æ ·æ­¥æ•°
â”‚ scale           FLOAT           â”‚  å¼•å¯¼ç³»æ•°
â”‚ seed            INTEGER         â”‚  éšæœºç§å­
â”‚ result_images   JSON            â”‚  ç»“æœå›¾ç‰‡åˆ—è¡¨
â”‚ error_message   TEXT            â”‚  é”™è¯¯ä¿¡æ¯
â”‚ retry_count     INTEGER         â”‚  é‡è¯•æ¬¡æ•°
â”‚ created_at      DATETIME        â”‚  åˆ›å»ºæ—¶é—´
â”‚ started_at      DATETIME        â”‚  å¼€å§‹æ—¶é—´
â”‚ completed_at    DATETIME        â”‚  å®Œæˆæ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           images                â”‚  å›¾ç‰‡è¡¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         INTEGER         â”‚
â”‚ image_id        VARCHAR(36)     â”‚  UUID
â”‚ task_id (FK)    INTEGER         â”‚  å…³è”ä»»åŠ¡
â”‚ file_path       VARCHAR(255)    â”‚  æ–‡ä»¶è·¯å¾„
â”‚ thumbnail_path  VARCHAR(255)    â”‚  ç¼©ç•¥å›¾è·¯å¾„
â”‚ file_size       INTEGER         â”‚  æ–‡ä»¶å¤§å°
â”‚ width           INTEGER         â”‚  å›¾ç‰‡å®½åº¦
â”‚ height          INTEGER         â”‚  å›¾ç‰‡é«˜åº¦
â”‚ created_at      DATETIME        â”‚  åˆ›å»ºæ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ N:1
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          user_tags              â”‚  æ ‡ç­¾è¡¨ (å¯é€‰)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         INTEGER         â”‚
â”‚ image_id (FK)   INTEGER         â”‚
â”‚ tag_name        VARCHAR(50)     â”‚
â”‚ created_at      DATETIME        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ç´¢å¼•è®¾è®¡

```sql
-- ä»»åŠ¡è¡¨ç´¢å¼•
CREATE INDEX idx_task_id ON tasks(task_id);
CREATE INDEX idx_status ON tasks(status);
CREATE INDEX idx_created_at ON tasks(created_at);

-- å›¾ç‰‡è¡¨ç´¢å¼•
CREATE INDEX idx_image_id ON images(image_id);
CREATE INDEX idx_task_id_fk ON images(task_id);

-- æ ‡ç­¾è¡¨ç´¢å¼•
CREATE INDEX idx_image_id_fk ON user_tags(image_id);
CREATE INDEX idx_tag_name ON user_tags(tag_name);
```

## 5. APIæ¥å£è®¾è®¡

### 5.1 æ¥å£æ¸…å•

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | è®¤è¯ |
|------|------|------|------|
| `/api/v1/generate` | POST | åˆ›å»ºç”Ÿæˆä»»åŠ¡ | å¦ |
| `/api/v1/task/{task_id}` | GET | æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€ | å¦ |
| `/api/v1/tasks` | GET | è·å–ä»»åŠ¡åˆ—è¡¨ | å¦ |
| `/api/v1/task/{task_id}` | DELETE | åˆ é™¤ä»»åŠ¡ | å¦ |
| `/api/v1/history` | GET | è·å–å†å²è®°å½• | å¦ |
| `/api/v1/history/{id}` | DELETE | åˆ é™¤å†å²è®°å½• | å¦ |
| `/api/v1/images/{image_id}` | GET | è·å–å›¾ç‰‡ | å¦ |
| `/api/v1/images/{image_id}/thumbnail` | GET | è·å–ç¼©ç•¥å›¾ | å¦ |
| `/api/v1/models` | GET | è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨ | å¦ |
| `/api/v1/system/info` | GET | è·å–ç³»ç»Ÿä¿¡æ¯ | å¦ |
| `/api/v1/health` | GET | å¥åº·æ£€æŸ¥ | å¦ |

### 5.2 æ¥å£è¯¦ç»†è®¾è®¡

#### åˆ›å»ºç”Ÿæˆä»»åŠ¡

```http
POST /api/v1/generate HTTP/1.1
Content-Type: application/json

{
  "prompt": "ä¸€åªå¯çˆ±çš„çŒ«å’ª",
  "negative_prompt": "æ¨¡ç³Š, ä½è´¨é‡",
  "model": "general_v2.0",
  "width": 1024,
  "height": 1024,
  "num_images": 1,
  "steps": 20,
  "scale": 7.5,
  "seed": null
}

Response 201:
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "pending",
  "created_at": "2024-01-01T12:00:00Z",
  "estimated_time": 30
}

Response 400:
{
  "error": "validation_error",
  "message": "æç¤ºè¯ä¸èƒ½ä¸ºç©º",
  "details": {...}
}

Response 429:
{
  "error": "rate_limit_exceeded",
  "message": "è¶…å‡ºå¹¶å‘ä»»åŠ¡é™åˆ¶",
  "retry_after": 60
}
```

#### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

```http
GET /api/v1/task/550e8400-e29b-41d4-a716-446655440000 HTTP/1.1

Response 200 (Processing):
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "processing",
  "progress": 45,
  "created_at": "2024-01-01T12:00:00Z",
  "started_at": "2024-01-01T12:00:05Z"
}

Response 200 (Completed):
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "completed",
  "progress": 100,
  "images": [
    {
      "image_id": "img_123456",
      "url": "/api/v1/images/img_123456",
      "thumbnail_url": "/api/v1/images/img_123456/thumbnail",
      "width": 1024,
      "height": 1024,
      "file_size": 2048576
    }
  ],
  "created_at": "2024-01-01T12:00:00Z",
  "started_at": "2024-01-01T12:00:05Z",
  "completed_at": "2024-01-01T12:00:25Z"
}

Response 404:
{
  "error": "not_found",
  "message": "ä»»åŠ¡ä¸å­˜åœ¨"
}
```

## 6. éƒ¨ç½²æ¶æ„

### 6.1 Dockerå®¹å™¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Docker Host                          â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           Docker Network: app-network             â”‚  â”‚
â”‚  â”‚                                                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚  â”‚  nginx:alpine    â”‚  â”‚ backend:python   â”‚      â”‚  â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚      â”‚  â”‚
â”‚  â”‚  â”‚  Port: 80        â”‚  â”‚ Port: 8000       â”‚      â”‚  â”‚
â”‚  â”‚  â”‚  â†’ æ˜ å°„åˆ° 8080    â”‚  â”‚ (å†…éƒ¨ç«¯å£)       â”‚      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â”‚           â”‚                      â”‚                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â”‚                      â”‚                    â”‚
â”‚              â–¼                      â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Docker Volumes                      â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  - ./data        â†’ /app/data      (æ•°æ®æŒä¹…åŒ–)  â”‚   â”‚
â”‚  â”‚  - ./logs        â†’ /app/logs      (æ—¥å¿—)        â”‚   â”‚
â”‚  â”‚  - ./nginx.conf  â†’ /etc/nginx     (é…ç½®)        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ç”Ÿäº§ç¯å¢ƒæ¶æ„ (å¯é€‰)

```
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  CloudFlare â”‚  CDN + DDoSé˜²æŠ¤
                      â”‚     CDN     â”‚
                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Load Balancer â”‚  è´Ÿè½½å‡è¡¡
                    â”‚    (Nginx)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                  â”‚                  â”‚
    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ App Node â”‚      â”‚ App Node â”‚      â”‚ App Node â”‚
    â”‚    #1    â”‚      â”‚    #2    â”‚      â”‚    #3    â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Shared Storage â”‚  å…±äº«å­˜å‚¨ (NFS/OSS)
                    â”‚   + Database    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. å®‰å…¨æ¶æ„

### 7.1 å®‰å…¨å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å±‚å®‰å…¨ (Application)         â”‚
â”‚  - è¾“å…¥éªŒè¯                              â”‚
â”‚  - è¾“å‡ºç¼–ç                               â”‚
â”‚  - CSRFä¿æŠ¤                             â”‚
â”‚  - XSSé˜²æŠ¤                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          APIå±‚å®‰å…¨ (API)                 â”‚
â”‚  - Rate Limiting                        â”‚
â”‚  - è¯·æ±‚ç­¾åéªŒè¯                          â”‚
â”‚  - JWT Token (å¯é€‰)                     â”‚
â”‚  - API Keyç®¡ç†                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç½‘ç»œå±‚å®‰å…¨ (Network)             â”‚
â”‚  - HTTPS/TLS                            â”‚
â”‚  - é˜²ç«å¢™è§„åˆ™                            â”‚
â”‚  - DDoSé˜²æŠ¤                             â”‚
â”‚  - IPç™½åå•                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       æ•°æ®å±‚å®‰å…¨ (Data)                  â”‚
â”‚  - å¯†é’¥åŠ å¯†å­˜å‚¨                          â”‚
â”‚  - æ•°æ®åº“åŠ å¯†                            â”‚
â”‚  - å®šæœŸå¤‡ä»½                              â”‚
â”‚  - è®¿é—®å®¡è®¡æ—¥å¿—                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 8. ç›‘æ§å’Œæ—¥å¿—

### 8.1 æ—¥å¿—æ¶æ„

```
åº”ç”¨æ—¥å¿— â†’ Loguru â†’ æ–‡ä»¶ (app.log)
         â†“
      æ—¥å¿—è½®è½¬ (æŒ‰æ—¥æœŸ/å¤§å°)
         â†“
      æ—¥å¿—èšåˆ (å¯é€‰: ELK Stack)
         â†“
      æ—¥å¿—åˆ†æå’Œå‘Šè­¦
```

### 8.2 ç›‘æ§æŒ‡æ ‡

- **ç³»ç»ŸæŒ‡æ ‡**: CPU, å†…å­˜, ç£ç›˜, ç½‘ç»œ
- **åº”ç”¨æŒ‡æ ‡**: è¯·æ±‚æ•°, å“åº”æ—¶é—´, é”™è¯¯ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: ç”Ÿæˆä»»åŠ¡æ•°, æˆåŠŸç‡, APIé…é¢ä½¿ç”¨
- **è‡ªå®šä¹‰æŒ‡æ ‡**: é˜Ÿåˆ—é•¿åº¦, å¹¶å‘ä»»åŠ¡æ•°

## 9. æ‰©å±•æ€§è®¾è®¡

### 9.1 æ°´å¹³æ‰©å±•æ–¹æ¡ˆ

```
å•æœºç‰ˆ (Phase 1)
    â†“
æ·»åŠ Redisç¼“å­˜
    â†“
å¤šå®ä¾‹ + è´Ÿè½½å‡è¡¡
    â†“
å¾®æœåŠ¡åŒ–
```

### 9.2 æ€§èƒ½ä¼˜åŒ–ç‚¹

1. **ç¼“å­˜ç­–ç•¥**
   - Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
   - CDNç¼“å­˜é™æ€èµ„æº
   - æµè§ˆå™¨ç¼“å­˜ç­–ç•¥

2. **å¼‚æ­¥å¤„ç†**
   - Celeryä»»åŠ¡é˜Ÿåˆ—
   - WebSocketå®æ—¶æ¨é€
   - æ‰¹é‡å¤„ç†ä¼˜åŒ–

3. **æ•°æ®åº“ä¼˜åŒ–**
   - ç´¢å¼•ä¼˜åŒ–
   - æŸ¥è¯¢ä¼˜åŒ–
   - åˆ†åº“åˆ†è¡¨

---

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024-01-01
